
{% load static %}
{% block title %}
{% endblock title%}
{% block content %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<style>

    .main-navbar {
        border-bottom: 1px solid #ccc;
    }

    .main-navbar .top-navbar {
        background-color: #3eb109;
        padding-top: 10px;
        padding-bottom: 10px;
    }

    .main-navbar .top-navbar .brand-name {
        color: #fff;
    }

    .main-navbar .top-navbar .nav-link {
        color: #fff;
        font-size: 16px;
        font-weight: 500;
    }

    .main-navbar .top-navbar .dropdown-menu {
        padding: 0px 0px;
        border-radius: 0px;
    }

    .main-navbar .top-navbar .dropdown-menu .dropdown-item {
        padding: 8px 16px;
        border-bottom: 1px solid #ccc;
        font-size: 14px;
    }

    .main-navbar .top-navbar .dropdown-menu .dropdown-item i {
        width: 20px;
        text-align: center;
        color: #2874f0;
        font-size: 14px;
    }

    .main-navbar .navbar {
        padding: 0px;
        background-color: #ddd;
    }

    .main-navbar .navbar .nav-item .nav-link {
        padding: 8px 20px;
        color: #000;
        font-size: 15px;
    }

    @media only screen and (max-width: 600px) {
        .main-navbar .top-navbar .nav-link {
            font-size: 12px;
            padding: 8px 10px;
        }
    }
    body {
            
            background-image: url('/static/image/bg5.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding-top: 10px;
        }

        .product-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .product-image {
            flex: 1;
        }

        .product-image img {
            width: 100%;
            max-width: 400px;
            height: auto;
        }

        .product-info {
            flex: 1;
            padding: 0 20px;
        }

        .product-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 18px;
            color: #e53935;
            margin-bottom: 10px;
        }

        .product-specs {
            margin-bottom: 20px;
        }

        .buy-button {
            background-color: #232f3e;
            color: #fff;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }
</style>
<!--navbar style end-->
<body>
  <!--navbar start-->

  <div class="main-navbar shadow-sm sticky-top">
      <div class="top-navbar">
          <div class="container-fluid">
              <div class="row">
                  <div class="col-md-2 my-auto d-none d-sm-none d-md-block d-lg-block">
                      <h5 class="brand-name"><i class="fa-solid fa-seedling"></i> Plant Nursery</h5>
                  </div>
                  <div class="col-md-5 my-auto">
                     
              <div class="input-group">
                <form class="d-flex" role="search" style="margin-left: 100px;" method="get" action="{% url 'srch' %}">
                  {% csrf_token %}
                  <input class="form-control" type="srch" placeholder="Search your plants" aria-label="Search" autocomplete="on" style="width:430px;" id="srch" name="q"> 
                  <button class="btn btn-outline-success ms-2 text-light" type="submit">Search</button>
              </form>
              </div>
                  </div>
                  <div class="col-md-5 my-auto">
                      <ul class="nav justify-content-end">

                          <li class="nav-item">
                              {% if request.user.is_authenticated %}
                              <a class="nav-link" href="#">
                                  <i class="fa fa-shopping-cart"></i> Cart
                              </a>
                              {% endif %}
                          </li>
                           <li class="nav-item">
                {% if request.user.is_authenticated %}
                <a class="nav-link" href="{% url 'order_list' %}">
                   Order
                </a>
                {% endif %}
              </li>
                          <!-- <li class="nav-item">
                              <a class="nav-link" href="#">
                                  <i class="fa fa-heart"></i> Wishlist
                              </a>
                          </li> -->
                          <li class="nav-item">

                              {% if request.user.is_authenticated %}
                              <a class="nav-link" href="{% url 'logout' %}"><i class="fa-solid fa-user"
                                      style="color: #ffffff;"></i> Logout</a>

                          </li>
                          {%else%}

                          <a class="nav-link" href="{% url 'login' %}"> <i class="fa-solid fa-user"
                                  style="color: #ffffff;"></i> Login/Signup</a>
                          {% endif %}
                          </li>
                          <!-- <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                      
                                      <li><a class="dropdown-item" href="#"><i class="fa fa-user"></i> Profile</a></li>
                                      <li><a class="dropdown-item" href="#"><i class="fa fa-list"></i> My Orders</a></li>
                                      <li><a class="dropdown-item" href="#"><i class="fa fa-heart"></i> My Wishlist</a></li>
                                      <li><a class="dropdown-item" href="#"><i class="fa fa-shopping-cart"></i> My Cart</a></li>
                                      <li><a class="dropdown-item" href="#"><i class="fa fa-sign-out"></i> Logout</a></li>
                                      </ul> -->

                      </ul>
                  </div>
              </div>
          </div>
      </div>
      <nav class="navbar navbar-expand-lg">
          <div class="container-fluid">
              <a class="navbar-brand d-block d-sm-block d-md-none d-lg-none" href="#">
                  Funda Ecom
              </a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                  data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                  aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <!-- <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav me-auto mb-2 mb-lg-0 ">
                      <li class="nav-item">
                          <a class="nav-link" href="{% url 'home' %}">Home</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link" href="#">All Categories</a>
                      </li>

                  </ul>
              </div> -->
          </div>
      </nav>
      <!--navbar end-->
<center><h3>Welcome {{request.user}} to the cart</h3></center>
<section class="h-100 h-custom " style="background-color: #f0e6e6 ;">
  <div class="container py-5 h-100 pt-10">
    <div class="row justify-content-center align-items-center h-100">
      <div class="col-lg-8 ">
        <div class="card card-registration card-registration-2" style="border-radius: 15px;">
          <div class="card-body p-0">
            <div class="p-5">
              <div class="d-flex justify-content-between align-items-center mb-5">
                <h1 class="fw-bold mb-0 text-center text-black">Shopping Cart</h1>
              </div>
              <hr class="my-4">

              {% for i in data %}
              <div class="row mb-4 d-flex justify-content-between align-items-center">
                <div class="col-md-2 col-lg-2 col-xl-2">
                  <img src="{{ i.item.product_image.url }}" class="img-fluid rounded-3" alt="Product Image">
                </div>
                <div class="col-md-3 col-lg-3 col-xl-3">
                  <!-- <h6 class="text-muted">Shirt</h6> -->
                  <h6 class="text-black mb-0">{{ i.item.name }}</h6>
                </div>
                <div class="col-md-3 col-lg-3 col-xl-2 d-flex align-items-center">
                  <button class="btn btn-link px-2 decrement-btn" data-item-id="{{ i.item.id }}">
                    <i class="fas fa-minus"></i>
                </button>
                <input id="quantity-{{ i.item.id }}" min="0" name="quantity" value="{{ i.item.quantity }}" type="text" class="form-control form-control-sm" style="width: 40px;" data-price="{{ i.item.selling_price }}">

                <button class="btn btn-link px-2 increment-btn" data-item-id="{{ i.item.id }}">
                    <i class="fas fa-plus"></i>
                </button>
               
                
                </div>
                <div class="col-md-3 col-lg-2 col-xl-2">
                  <h6 class="mb-0"><del>&#2352;</del> <span id="totalPrice-{{ i.item.id }}"></span></h6>
                </div>
                <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                  <a href="{% url 'order' i.item.id %}" class="text-muted"><i class="fa fa-shopping-bag"></i></a>
                </div>
                <div class="col-md-1 col-lg-1 col-xl-1 text-end">
                  <a href="{% url 'cart_delete' i.id %}" class="text-muted"><i class="fas fa-times"></i></a>
                </div>
                
              </div>
              {% endfor %}
              
              <hr class="my-4">
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<style>
  
@media (min-width: 1025px) {
  .h-custom {
    height: 100vh !important;
  }
}

.card-registration .select-input.form-control[readonly]:not([disabled]) {
  font-size: 1rem;
  line-height: 2.15;
  padding-left: .75em;
  padding-right: .75em;
}

.card-registration .select-arrow {
  top: 13px;
}

.bg-grey {
  background-color: #eae8e8;
}

@media (min-width: 992px) {
  .card-registration-2 .bg-grey {
    border-top-right-radius: 16px;
    border-bottom-right-radius: 16px;
  }
}

@media (max-width: 991px) {
  .card-registration-2 .bg-grey {
    border-bottom-left-radius: 16px;
    border-bottom-right-radius: 16px;
  }
}

</style>
</div>
</body>

{% endblock content %}
<script>
  
  // Function to calculate total price based on quantity
  function calculateTotalPrice(itemId) {
    // Get the quantity input field
    var quantityInput = document.getElementById('quantity-' + itemId);

    // Get the total price element
    var totalPriceElement = document.getElementById('totalPrice-' + itemId);

    // Get the price per item
    var pricePerItem = parseFloat(quantityInput.getAttribute('data-price'));

    // Get the quantity value
    var quantity = parseInt(quantityInput.value);

    // Calculate the total price
    var totalPrice = pricePerItem * quantity;

    // Update the total price element with the calculated value
    totalPriceElement.textContent = totalPrice.toFixed(2);
  }

  // Get all elements with the class 'increment-btn' and 'decrement-btn'
  var incrementButtons = document.querySelectorAll('.increment-btn');
  var decrementButtons = document.querySelectorAll('.decrement-btn');

  // Loop through each button and attach an event listener for increment
  incrementButtons.forEach(function(button) {
    button.addEventListener('click', function() {
      // Get the item ID from the data attribute
      var itemId = this.getAttribute('data-item-id');

      // Get the current quantity input field
      var quantityInput = document.getElementById('quantity-' + itemId);

      // Increment the quantity value
      quantityInput.value = parseInt(quantityInput.value) + 1;

      // Calculate and update the total price
      calculateTotalPrice(itemId);
    });
  });

  // Loop through each button and attach an event listener for decrement
  decrementButtons.forEach(function(button) {
    button.addEventListener('click', function() {
      // Get the item ID from the data attribute
      var itemId = this.getAttribute('data-item-id');

      // Get the current quantity input field
      var quantityInput = document.getElementById('quantity-' + itemId);

      // Decrement the quantity value, ensuring it doesn't go below 0
      var newValue = parseInt(quantityInput.value) - 1;
      if (newValue >= 0) {
        quantityInput.value = newValue;

        // Calculate and update the total price
        calculateTotalPrice(itemId);
      }
    });
  });

  // Calculate and update total price when the page loads
  window.addEventListener('load', function() {
    var quantityInputs = document.querySelectorAll('[id^=quantity-]');
    quantityInputs.forEach(function(quantityInput) {
      var itemId = quantityInput.getAttribute('data-item-id');
      calculateTotalPrice(itemId);
    });
  });
</script>


